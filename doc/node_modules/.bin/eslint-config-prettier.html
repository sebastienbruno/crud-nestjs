<!DOCTYPE html>
<html>
<head>
  <title>eslint-config-prettier</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/.bin/eslint-config-prettier";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>eslint-config-prettier</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">#!/usr/bin/env node</span>

<span class="hljs-meta">"use strict"</span>;

<span class="hljs-keyword">const</span> validators = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./validators"</span>);
<span class="hljs-keyword">const</span> config = <span class="hljs-built_in">require</span>(<span class="hljs-string">".."</span>);
<span class="hljs-keyword">const</span> prettier = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../prettier"</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>Require locally installed eslint, for <code>npx eslint-config-prettier</code> support
with no local eslint-config-prettier installation.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">const</span> { ESLint } = <span class="hljs-built_in">require</span>(<span class="hljs-built_in">require</span>.resolve(<span class="hljs-string">"eslint"</span>, {
  <span class="hljs-attr">paths</span>: [process.cwd(), ...require.resolve.paths(<span class="hljs-string">"eslint"</span>)],
}));

<span class="hljs-keyword">const</span> SPECIAL_RULES_URL =
  <span class="hljs-string">"https://github.com/prettier/eslint-config-prettier#special-rules"</span>;

<span class="hljs-keyword">const</span> PRETTIER_RULES_URL =
  <span class="hljs-string">"https://github.com/prettier/eslint-config-prettier#arrow-body-style-and-prefer-arrow-callback"</span>;

<span class="hljs-keyword">if</span> (<span class="hljs-built_in">module</span> === <span class="hljs-built_in">require</span>.main) {
  <span class="hljs-keyword">const</span> args = process.argv.slice(<span class="hljs-number">2</span>);

  <span class="hljs-keyword">if</span> (args.length === <span class="hljs-number">0</span>) {
    <span class="hljs-built_in">console</span>.error(help());
    process.exit(<span class="hljs-number">1</span>);
  }

  <span class="hljs-keyword">const</span> eslint = <span class="hljs-keyword">new</span> ESLint();

  <span class="hljs-built_in">Promise</span>.all(args.map(<span class="hljs-function">(<span class="hljs-params">file</span>) =&gt;</span> eslint.calculateConfigForFile(file)))
    .then(<span class="hljs-function">(<span class="hljs-params">configs</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> rules = [].concat(
        ...configs.map(<span class="hljs-function">(<span class="hljs-params">{ rules }, index</span>) =&gt;</span>
          <span class="hljs-built_in">Object</span>.entries(rules).map(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> [...entry, args[index]])
        )
      );
      <span class="hljs-keyword">const</span> result = processRules(rules);
      <span class="hljs-keyword">if</span> (result.stderr) {
        <span class="hljs-built_in">console</span>.error(result.stderr);
      }
      <span class="hljs-keyword">if</span> (result.stdout) {
        <span class="hljs-built_in">console</span>.error(result.stdout);
      }
      process.exit(result.code);
    })
    .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.error(error.message);
      process.exit(<span class="hljs-number">1</span>);
    });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">help</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`
Usage: npx eslint-config-prettier FILE...

Resolves an ESLint configuration for every given FILE and checks if they
contain rules that are unnecessary or conflict with Prettier. Example:

  npx eslint-config-prettier index.js test/index.js other/file/to/check.js

Exit codes:

0: No automatically detectable problems found.
1: General error.
2: Conflicting rules found.

For more information, see:
https://github.com/prettier/eslint-config-prettier#cli-helper-tool
  `</span>.trim();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processRules</span>(<span class="hljs-params">configRules</span>) </span>{
  <span class="hljs-keyword">const</span> regularRules = filterRules(config.rules, (_, value) =&gt; value === <span class="hljs-string">"off"</span>);
  <span class="hljs-keyword">const</span> optionsRules = filterRules(
    config.rules,
    (ruleName, value) =&gt; value === <span class="hljs-number">0</span> &amp;&amp; ruleName <span class="hljs-keyword">in</span> validators
  );
  <span class="hljs-keyword">const</span> specialRules = filterRules(
    config.rules,
    (ruleName, value) =&gt; value === <span class="hljs-number">0</span> &amp;&amp; !(ruleName <span class="hljs-keyword">in</span> validators)
  );

  <span class="hljs-keyword">const</span> enabledRules = configRules
    .map(<span class="hljs-function">(<span class="hljs-params">[ruleName, value, source]</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> arrayValue = <span class="hljs-built_in">Array</span>.isArray(value) ? value : [value];
      <span class="hljs-keyword">const</span> [level, ...options] = arrayValue;
      <span class="hljs-keyword">const</span> isOff = level === <span class="hljs-string">"off"</span> || level === <span class="hljs-number">0</span>;
      <span class="hljs-keyword">return</span> isOff ? <span class="hljs-literal">null</span> : { ruleName, options, source };
    })
    .filter(<span class="hljs-built_in">Boolean</span>);

  <span class="hljs-keyword">const</span> flaggedRules = enabledRules.filter(
    <span class="hljs-function">(<span class="hljs-params">{ ruleName }</span>) =&gt;</span> ruleName <span class="hljs-keyword">in</span> config.rules
  );

  <span class="hljs-keyword">const</span> regularFlaggedRuleNames = filterRuleNames(
    flaggedRules,
    ({ ruleName }) =&gt; ruleName <span class="hljs-keyword">in</span> regularRules
  );
  <span class="hljs-keyword">const</span> optionsFlaggedRuleNames = filterRuleNames(
    flaggedRules,
    ({ ruleName, ...rule }) =&gt;
      ruleName <span class="hljs-keyword">in</span> optionsRules &amp;&amp; !validators[ruleName](rule)
  );
  <span class="hljs-keyword">const</span> specialFlaggedRuleNames = filterRuleNames(
    flaggedRules,
    ({ ruleName }) =&gt; ruleName <span class="hljs-keyword">in</span> specialRules
  );
  <span class="hljs-keyword">const</span> prettierFlaggedRuleNames = filterRuleNames(
    enabledRules,
    ({ ruleName, source }) =&gt;
      ruleName <span class="hljs-keyword">in</span> prettier.rules &amp;&amp;
      enabledRules.some(
        <span class="hljs-function">(<span class="hljs-params">rule</span>) =&gt;</span>
          rule.ruleName === <span class="hljs-string">"prettier/prettier"</span> &amp;&amp; rule.source === source
      )
  );

  <span class="hljs-keyword">const</span> regularMessage = [
    <span class="hljs-string">"The following rules are unnecessary or might conflict with Prettier:"</span>,
    <span class="hljs-string">""</span>,
    printRuleNames(regularFlaggedRuleNames),
  ].join(<span class="hljs-string">"\n"</span>);

  <span class="hljs-keyword">const</span> optionsMessage = [
    <span class="hljs-string">"The following rules are enabled with config that might conflict with Prettier. See:"</span>,
    SPECIAL_RULES_URL,
    <span class="hljs-string">""</span>,
    printRuleNames(optionsFlaggedRuleNames),
  ].join(<span class="hljs-string">"\n"</span>);

  <span class="hljs-keyword">const</span> specialMessage = [
    <span class="hljs-string">"The following rules are enabled but cannot be automatically checked. See:"</span>,
    SPECIAL_RULES_URL,
    <span class="hljs-string">""</span>,
    printRuleNames(specialFlaggedRuleNames),
  ].join(<span class="hljs-string">"\n"</span>);

  <span class="hljs-keyword">const</span> prettierMessage = [
    <span class="hljs-string">"The following rules can cause issues when using eslint-plugin-prettier at the same time."</span>,
    <span class="hljs-string">"Only enable them if you know what you are doing! See:"</span>,
    PRETTIER_RULES_URL,
    <span class="hljs-string">""</span>,
    printRuleNames(prettierFlaggedRuleNames),
  ].join(<span class="hljs-string">"\n"</span>);

  <span class="hljs-keyword">if</span> (
    regularFlaggedRuleNames.length === <span class="hljs-number">0</span> &amp;&amp;
    optionsFlaggedRuleNames.length === <span class="hljs-number">0</span>
  ) {
    <span class="hljs-keyword">const</span> message =
      specialFlaggedRuleNames.length === <span class="hljs-number">0</span> &amp;&amp;
      prettierFlaggedRuleNames.length === <span class="hljs-number">0</span>
        ? <span class="hljs-string">"No rules that are unnecessary or conflict with Prettier were found."</span>
        : [
            specialFlaggedRuleNames.length === <span class="hljs-number">0</span> ? <span class="hljs-literal">null</span> : specialMessage,
            prettierFlaggedRuleNames.length === <span class="hljs-number">0</span> ? <span class="hljs-literal">null</span> : prettierMessage,
            <span class="hljs-string">"Other than that, no rules that are unnecessary or conflict with Prettier were found."</span>,
          ]
            .filter(<span class="hljs-built_in">Boolean</span>)
            .join(<span class="hljs-string">"\n\n"</span>);

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">stdout</span>: message,
      <span class="hljs-attr">code</span>: <span class="hljs-number">0</span>,
    };
  }

  <span class="hljs-keyword">const</span> message = [
    regularFlaggedRuleNames.length === <span class="hljs-number">0</span> ? <span class="hljs-literal">null</span> : regularMessage,
    optionsFlaggedRuleNames.length === <span class="hljs-number">0</span> ? <span class="hljs-literal">null</span> : optionsMessage,
    specialFlaggedRuleNames.length === <span class="hljs-number">0</span> ? <span class="hljs-literal">null</span> : specialMessage,
    prettierFlaggedRuleNames.length === <span class="hljs-number">0</span> ? <span class="hljs-literal">null</span> : prettierMessage,
  ]
    .filter(<span class="hljs-built_in">Boolean</span>)
    .join(<span class="hljs-string">"\n\n"</span>);

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">stdout</span>: message,
    <span class="hljs-attr">code</span>: <span class="hljs-number">2</span>,
  };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filterRules</span>(<span class="hljs-params">rules, fn</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.entries(rules)
    .filter(<span class="hljs-function">(<span class="hljs-params">[ruleName, value]</span>) =&gt;</span> fn(ruleName, value))
    .reduce(<span class="hljs-function">(<span class="hljs-params">obj, [ruleName]</span>) =&gt;</span> {
      obj[ruleName] = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">return</span> obj;
    }, <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filterRuleNames</span>(<span class="hljs-params">rules, fn</span>) </span>{
  <span class="hljs-keyword">return</span> [
    ...new <span class="hljs-built_in">Set</span>(rules.filter(<span class="hljs-function">(<span class="hljs-params">rule</span>) =&gt;</span> fn(rule)).map(<span class="hljs-function">(<span class="hljs-params">rule</span>) =&gt;</span> rule.ruleName)),
  ];
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printRuleNames</span>(<span class="hljs-params">ruleNames</span>) </span>{
  <span class="hljs-keyword">return</span> ruleNames
    .slice()
    .sort()
    .map(<span class="hljs-function">(<span class="hljs-params">ruleName</span>) =&gt;</span> <span class="hljs-string">`- <span class="hljs-subst">${ruleName}</span>`</span>)
    .join(<span class="hljs-string">"\n"</span>);
}

exports.processRules = processRules;

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
